# 川柳動画ジェネレーター

日本語の川柳（せんりゅう）を音声合成とテキストオーバーレイで動画コンテンツを自動生成する bash スクリプトです。

## 川柳とは？

川柳（せんりゅう）は俳句に似た日本の詩の形式で、自然ではなく人間性や感情に焦点を当てます。5-7-5 の音節パターンに従い、ユーモアや社会風刺を含むことが多いです。

## 機能

- **自動音声合成**: 日本語テキストを自然な音声に変換
- **スマートフレーズ検出**: フレーズ間のポーズを自動検出してタイミング調整
- **動画生成**: 音声に同期したテキストオーバーレイ付き MP4 動画を作成
- **音声カスタマイズ**: 複数の日本語音声から選択可能（京子、音也など）
- **タイミング調整**: 話速とフレーズ間のポーズ時間を制御可能

## 必要要件

- macOS（音声合成に`say`コマンドを使用）
- ffmpeg（音声・動画処理用）
- Python 3（計算用）

## インストール

1. このリポジトリをクローンまたはダウンロード
2. スクリプトを実行可能にする：
   ```bash
   chmod +x auto_three_phrase.sh
   ```

## 使用方法

### 基本的な使用方法

```bash
./auto_three_phrase.sh "医者笑い  企業は拍手  肺が泣く"
```

### 高度な使用方法

```bash
./auto_three_phrase.sh "フレーズ1  フレーズ2  フレーズ3" [出力ファイル.mp4] [音声] [話速] [ポーズ時間]
```

### パラメータ

- **入力テキスト**: 全角スペース（　）または複数の半角スペースで区切られた 3 つのフレーズ
- **出力ファイル**（オプション）: 出力動画ファイル名（デフォルト: `out.mp4`）
- **音声**（オプション）: 使用する TTS 音声（デフォルト: `Kyoko`）
  - 利用可能な音声: `Kyoko`（女性）、`Otoya`（男性）など
- **話速**（オプション）: 話速、140-200 が推奨（デフォルト: `170`）
- **ポーズ時間**（オプション）: フレーズ間のポーズ時間（ミリ秒）（デフォルト: `600`）

### 使用例

```bash
# 基本的な使用
./auto_three_phrase.sh "春の雨  傘を忘れて  濡れて帰る"

# カスタム出力と音声
./auto_three_phrase.sh "夏の夜  花火を見て  涙が出る" "summer_senryu.mp4" "Otoya"

# 話速とポーズを調整
./auto_three_phrase.sh "秋の風  葉っぱが舞って  心も舞う" "autumn.mp4" "Kyoko" "150" "800"
```

## 動作原理

1. **テキスト処理**: スペース検出を使用して入力を 3 つのフレーズに分割
2. **音声合成**: macOS の`say`コマンドを使用してポーズ付きの音声を生成
3. **音声処理**: MP3 に変換し、タイミング用の無音点を検出
4. **動画作成**: 音声に同期したテキストオーバーレイ付きの黒背景動画を生成
5. **出力**: 音声と視覚的テキストを含む最終 MP4 ファイルを生成

## 出力ファイル

スクリプトは以下を生成します：

- `1.aiff` - 生音声ファイル
- `1.mp3` - 処理済み音声ファイル
- `silences.log` - 無音検出ログ
- `[出力ファイル].mp4` - テキストオーバーレイ付き最終動画

## トラブルシューティング

- **"区切りが足りません"**: フレーズ間に適切なスペース（全角スペースまたは複数の半角スペース）を使用してください
- **音声の問題**: `say`コマンドが動作することを確認: `say "test"`
- **動画の問題**: ffmpeg がインストールされていることを確認: `ffmpeg -version`

## ライセンス

このプロジェクトはオープンソースです。自由に修正・配布してください。
